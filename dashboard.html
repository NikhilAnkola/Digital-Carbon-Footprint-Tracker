<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>Digital Carbon Footprint ‚Äì Dashboard</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link rel="stylesheet" href="dashboard.css">
<style>
    :root { color-scheme: light dark; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 24px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 16px; }
    .card { padding: 16px; border-radius: 12px; box-shadow: 0 6px 22px rgba(0,0,0,.08); background: Canvas; color: CanvasText; }
    h1 { margin-top: 0; margin-bottom: 12px; }
    h2 { margin: 0 0 12px; font-size: 16px; font-weight: 600; }
    .big { font-size: 28px; font-weight: 700; }
    table { width: 100%; border-collapse: collapse; margin-top: 16px; }
    th, td { text-align: left; padding: 8px; border-bottom: 1px solid rgba(127,127,127,.25); }
    .muted { opacity: .7; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
    .btn { padding: 6px 12px; margin: 2px; border-radius: 6px; border: 1px solid rgba(127,127,127,.4); background: ButtonFace; cursor: pointer; }
    .btn:hover { background: rgba(127,127,127,.15); }
    .chart-wrap { margin-top: 12px; }
    .header-row { display: flex; justify-content: space-between; align-items: center; }
    .empty.hidden { display: none; }
</style>
</head>
<body>
    <!-- State Selection -->
    <label for="stateSelect"><b>Select your state:</b></label>
    <select id="stateSelect">
        <option value="default">India (Default)</option>
        <option value="Andhra Pradesh">Andra Pradesh</option>
        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
        <option value="Ass am">Assam</option>
        <option value="Bi har">Bihar</option>
        <option value="Chhattis garh">Chattisgarh</option>
        <option value="Go a">Goa</option>
        <option value="Guja rat">Gujarat</option>
        <option value="Har yana">Haryana</option>
        <option value="Himachal Pradesh">Himachal Pradesh</option>
        <option value="Jharkh and">Jharkhand</option>
        <option value="Karna taka">Karnataka</option>
        <option value="Ker ala">Kerala</option>
        <option value="Madhya Pradesh">Madhya Pradesh</option>
        <option value="Mahar ashtra">Maharashtra</option>
        <option value="Mani pur">Manipur</option>
        <option value="Megha laya">Meghalaya</option>
        <option value="Mizo ram">Mizoram</option>
        <option value="Naga land">Nagaland</option>
        <option value="Odi sha">Odisha</option>
        <option value="Pun jab">Punjab</option>
        <option value="Rajas than">Rajasthan</option>
        <option value="Sikk im">Sikkim</option>
        <option value="Tamil Nadu">Tamil Nadu</option>
        <option value="Telan gana">Telangana</option>
        <option value="Tri pura">Tripura</option>
        <option value="Uttar Pradesh">Uttar Pradesh</option>
        <option value="Uttara khand">Uttarakhand</option>
        <option value="West Bengal">West Bengal</option>
    </select>

    <hr>

    <!-- === Today's Usage: CO‚ÇÇ by Site (Pie) === -->
    <section class="card">
    <h2>Today's Usage ‚Äî CO‚ÇÇ by Site</h2>
    <div class="chart-wrap">
        <canvas id="todayPieChart" width="400" height="400" aria-label="Today CO2 share by site"></canvas>
        <div id="todayPieEmpty" class="empty hidden">No data for today yet.</div>
    </div>
    </section>

    <!-- Today's Usage Summary -->
    <h3>Today's Usage Summary</h3>
    <div id="usageContainer"><p>Loading...</p></div>
    <ul>
        <li><b>Total CO‚ÇÇ emitted:</b> <span id="totalCO2">0</span> g</li>
        <li><b>Equivalent to:</b> <span id="co2Equivalent">‚Äì</span></li>
    </ul>

    <!-- Prediction Section -->
    <div>
        <label>Days Ahead:</label>
        <input type="number" id="daysAhead" min="1" max="7" value="1">
        <button id="predictBtn">Predict</button>
        <div id="predictionResult">Prediction will appear here.</div>
    </div>

    <hr />

    <!-- === Last 28 Days: CO‚ÇÇ per Day (Bar, 7 at a time) === -->
    <section class="card">
    <div class="header-row">
        <h2>Last 28 Days ‚Äî CO‚ÇÇ per Day</h2>
        <div class="pager">
        <button id="prev7" type="button" class="btn">Prev 7</button>
        <button id="next7" type="button" class="btn">Next 7</button>
        </div>
    </div>
    <div class="chart-wrap">
        <canvas id="historyBarChart" width="700" height="360" aria-label="Last 28 days CO2 bar chart"></canvas>
        <div id="historyBarEmpty" class="empty hidden">No history yet.</div>
    </div>
    </section>

    <!-- Last 28 Days History -->
    <h3>Last 28 Days History</h3>
    <div id="historyContainer"><p>Loading history...</p></div>

    <hr />

    <!-- === Gamification Section === -->
    <div id="gamification-section" class="card">
      <h3>üåü Gamification</h3>

      <div id="streak-display">
        <strong>üî• Daily Streak:</strong> <span id="streakCount">0</span> days
        <p>Stay under 300g CO‚ÇÇ per day to increase your streak.</p>
      </div>

      <div id="eco-points-display">
        <strong>‚≠ê Eco Points:</strong> <span id="ecoPoints">0</span>
        <p>Earn up to 5 points daily.  
        Future scope: redeem for rewards üéÅ (e.g., subscriptions).</p>
      </div>

      <div id="garden-display">
        <strong>üå± Virtual Garden:</strong>
        <div id="gardenStages"></div>
        <p>Seedling (20 pts), Small Plant (50 pts), Tree (100 pts)</p>
      </div>
    </div>

    <hr />

    <!-- Buttons -->
    <button id="resetBtn" class="btn">Reset All Data</button>
    <button id="refreshChartsBtn" class="btn">Refresh Charts</button>

    <script src="rule_suggestions.js"></script>
    <script src="popup.js" defer></script>

    <!-- Load Chart.js from local file -->
    <script src="libs/chart.umd.js"></script>
    
    <!-- Dashboard chart logic -->
    <script src="dashboard-charts.js"></script>
</body>
</html>
